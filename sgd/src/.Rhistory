source("../src/checkCGDBdata.R")
data <- loadCGDBdata(paste0("../data/Report-",params$report_id,".txt"))
data <- checkCGDBdata(data,remo
source("../src/loadCGDBdata.R")
source("../src/checkCGDBdata.R")
data <- loadCGDBdata(paste0("../data/Report-",params$report_id,".txt"))
setwd("~/Documents/Academia/Projects/GAGinCancer/cancergags/scripts")
source("../src/loadCGDBdata.R")
source("../src/checkCGDBdata.R")
source("../src/loadCGDBdata.R")
source("../src/checkCGDBdata.R")
data <- loadCGDBdata(paste0("../data/Report-",params$report_id,".txt"))
data <- checkCGDBdata(data,removereplicates = F,removelongitudinal = F,expand = T,renamemissingfields=T)
head(data)
source("../src/fetchprimaryneoplasticdisease.R")
source("../src/fetchcohort.R")
conditions    <- fetchprimaryneoplasticdisease(params$conditions)
fluid         <- switch(params$fluid,
"bu"="combined",
"b"="blood",
"u"="urine")
gagclass      <- params$gagclass
status        <- F
excludeNED    <- F
cohort        <- fetchcohort(params$cohort)
source("../src/describedata.R")
kable(data.frame(Parameters=c("Condition(s)","Fluid(s)","GAG class(es)","Cohort(s)"),
Values=c(paste(conditions,sep = "",collapse = "//"),
fluid,gagclass,ifelse(is.null(cohort),"ALL cohorts",cohort))
))
describedata(data,conditions,fluid,gagclass,status,excludeNED,cohort)
kable(data.frame(Parameters=c("Condition(s)","Fluid(s)","GAG class(es)","Cohort(s)"),
Values=c(paste(conditions,sep = "",collapse = "//"),
fluid,gagclass,ifelse(is.null(cohort),"ALL cohorts",cohort))
))
source("../src/fetchprimaryneoplasticdisease.R")
source("../src/fetchcohort.R")
conditions    <- fetchprimaryneoplasticdisease(params$conditions)
fluid         <- switch(params$fluid,
"bu"="combined",
"b"="blood",
"u"="urine")
gagclass      <- params$gagclass
status        <- F
excludeNED    <- F
cohort        <- fetchcohort(params$cohort)
source("../src/describedata.R")
kable(data.frame(Parameters=c("Condition(s)","Fluid(s)","GAG class(es)","Cohort(s)"),
Values=c(paste(conditions,sep = "",collapse = "//"),
fluid,gagclass,ifelse(is.null(cohort),"ALL cohorts",cohort))
))
describedata(data,conditions,fluid,gagclass,status,excludeNED,cohort)
source("../src/computeGAGdifference.R")
res <- computeGAGdifference(data,
conditions=conditions,
status    = status,
cohort    = cohort,
excludeNED     = excludeNED,
overridefactor = "Primary_neoplastic_diseases_supergroup",
GAGs=NULL)
kable(data.frame(Parameters=c("Condition(s)","Fluid(s)","GAG class(es)","Cohort(s)"),
Values=c(paste(conditions,sep = "",collapse = "//"),
fluid,gagclass,ifelse(is.null(cohort),"ALL cohorts",cohort))
))
describedata(data,conditions,fluid,gagclass,status,excludeNED,cohort)
source("../src/fetchprimaryneoplasticdisease.R")
source("../src/fetchcohort.R")
conditions    <- fetchprimaryneoplasticdisease(params$conditions)
fluid         <- switch(params$fluid,
"bu"="combined",
"b"="blood",
"u"="urine")
gagclass      <- params$gagclass
status        <- F
excludeNED    <- F
cohort        <- fetchcohort(params$cohort)
source("../src/describedata.R")
kable(data.frame(Parameters=c("Condition(s)","Fluid(s)","GAG class(es)","Cohort(s)"),
Values=c(paste(conditions,sep = "",collapse = "//"),
fluid,gagclass,ifelse(is.null(cohort),"ALL cohorts",cohort))
))
describedata(data,conditions,fluid,gagclass,status,excludeNED,cohort)
source("../src/computeGAGdifference.R")
res <- computeGAGdifference(data,
conditions=conditions,
status    = status,
cohort    = cohort,
excludeNED     = excludeNED,
overridefactor = "Primary_neoplastic_diseases_supergroup",
GAGs=NULL)
inferdiffGAG <- function(BESTout){
BEST.summary <- summary(BESTout)
percgreatercompval <- BEST.summary["muDiff","%>compVal"]
percgreatercompval
}
percgreatercompval <- unlist(lapply(res,inferdiffGAG))
percgreatercompval
plotAll(res$X0s_CS_urine)
plotAll(res$X0s_CS_urine)
plotAll(res$X0s_CS_plasma)
setwd("~/Documents/Academia/Projects/GAGinCancer/cancergags")
save("res","intermediate/BEST_20170322211408_pcaANDh_inALL.rda")
save("res","intermediate/BEST_20170322223506_ccrccANDh_inALL.rda")
save("res",file = "intermediate/BEST_20170322223506_ccrccANDh_inALL.rda")
setwd("~/Documents/Academia/Projects/Recon3D/Recon3D/sgd")
hpa <- read.delim("data/rna_celline.csv",sep = ",")
head(hpa)
load("~/Documents/Data/Geneannot/annotation_ensembl_gene_id.RData")
head(annotEntrez)
tail(annotEntrez)
head(hpa)
b <- merge(hpa,annotEntrez,"Gene","ensembl_gene_id")
b <- merge(hpa,annotEntrez,by.x = "Gene",by.y = "ensembl_gene_id")
head(b)
library(dplyr)
hpa.annot <- b
unique(hpa$Sample)
scores <- filter(hpa.annot,Sample %in% c("U-251 MG","U-87 MG")) %>%
select(Sample,entrezgene,Value)
head(scores)
library(reshape)
?melt
library(reshape2)
dcast(scores,entrezgene~Sample)
a<-dcast(scores,entrezgene~Sample)
head(a)
a<-dcast(scores,entrezgene~Sample,value.var = "Value")
head(a)
?dcast
e
names(airquality) <- tolower(names(airquality))
aqm <- melt(airquality, id=c("month", "day"), na.rm=TRUE)
head(aqm)
a<-dcast(scores,Sample~entrezgene,value.var = "Value")
head(a)
a[1:2,1:4]
head(aqm)
acast(aqm, day ~ month ~ variable)
scores
a<-dcast(scores,Values~Sample)
a<-dcast(scores,Value~Sample)
head(scores)
head(a)
a<-dcast(scores,Value~Sample,value.var = entrezgene)
?aggregate
aggregate(scores,by = "Sample")
a<-dcast(scores, entrezgene~Sample)
head(a)
tail(a)
?dcast
SN = c(1:100, 1:100, 1:100, 1:100)
class = c(rep("A1", 100), rep("B2", 100), rep("C3", 100), rep("D4", 100)) # total 6000 levels
myvar = rnorm(400)
mydf = data.frame(SN, class, myvar)
head(mydf)
> dcast(mydf, SN ~ class)
dcast(mydf, SN ~ class)
a<-dcast(scores, entrezgene~Sample)
scores
tail(scores)
table(scores$Sample)
table(scores$entrezgene)
all(table(scores$entrezgene)==2)
table(scores$entrezgene)==2
which(table(scores$entrezgene)!=2)
table(scores$entrezgene)[which(table(scores$entrezgene)!=2)]
a<-dcast(scores, entrezgene~Sample,fun.aggregate = "mean")
a<-dcast(scores, entrezgene~Sample,fun.aggregate = mean)
head(a)
a
a<-dcast(scores, entrezgene~Sample,fun.aggregate = max)
a<-dcast(scores, entrezgene~Sample,fun.aggregate = mean())
a<-dcast(scores, entrezgene~Sample,fun.aggregate = mean
)
a<-dcast(scores, entrezgene~Sample,fun.aggregate = mean,value.var = Value)
a<-dcast(scores, entrezgene~Sample,fun.aggregate = mean,value.var = "Value")
tpm <- filter(hpa.annot,Sample %in% c("U-251 MG","U-87 MG")) %>%
select(Sample,entrezgene,Value)
#Aggregate TPM
library(reshape2)
scores <-dcast(tpm, entrezgene~Sample,fun.aggregate = mean,value.var = "Value")
head(scores)
rownames(scores) <- scores$entrezgene
scores <- scores[,-which(colnames(scores)=="entrezgene")]
scores <-dcast(tpm, entrezgene~Sample,fun.aggregate = mean,value.var = "Value")
scores <-dcast(tpm, entrezgene~Sample,fun.aggregate = mean,value.var = "Value") %>% na.omit()
scores <-dcast(tpm, entrezgene~Sample,fun.aggregate = mean,value.var = "Value") %>% na.omit()
rownames(scores) <- scores$entrezgene
scores <- scores[,-which(colnames(scores)=="entrezgene")]
head(scores)
tail(scores)
setwd("~/Documents/Academia/Projects/Recon3D/Recon3D/sgd/src")
write.csv(scores,file = "../data/rna_celline2tpm.csv")
